# API 模块

**功能职责：**

本模块定义了`website-scanner`服务对外暴露的HTTP API接口。这些接口主要用于查询扫描任务的状态和结果，供前端`web-admin`或其他内部服务调用。

## 文件说明

- `__init__.py`: Python包标识文件。
- `scan.py`: 定义与扫描任务和结果相关的API接口。例如：
  - **`GET /api/v1/scans`**: 查询扫描任务列表，支持分页和过滤。
  - **`GET /api/v1/scans/{scan_id}`**: 获取指定ID的扫描任务的详细信息，包括其基本设置和总体结果。
  - **`GET /api/v1/scans/{scan_id}/results`**: 获取指定扫描任务发现的具体违规结果列表，支持分页和按风险类型过滤。

## 开发规范

- **RESTful设计**: API应遵循RESTful设计风格，使用标准的HTTP方法（GET, POST, PUT, DELETE）和状态码。
- **Pydantic模型**: 请求参数（如查询过滤器）和响应体都应使用Pydantic模型进行定义和验证，确保接口数据的类型安全和一致性。
- **依赖注入**: 使用FastAPI的依赖注入系统来获取数据库会话和服务实例，例如 `db: Session = Depends(get_db)`。
- **认证与授权**: 所有API接口都应受到保护。应通过一个共享的认证服务或中间件来验证调用者的身份和权限。
- **清晰的版本控制**: 在API路径中包含版本号（如`/api/v1/`），便于未来的升级和迭代。
- **分页**: 对于返回列表数据的接口，必须实现分页功能（如使用`offset`和`limit`参数），避免一次性返回大量数据导致性能问题。