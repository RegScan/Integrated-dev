# 安全配置说明

## 概述

本项目已配置了完整的安全保护机制，确保敏感信息不会被意外提交到版本控制系统。

## 已保护的文件类型

### 1. 环境变量文件
- `.env` - 环境变量文件
- `.env.local` - 本地环境变量
- `.env.production` - 生产环境变量

### 2. 配置文件
- `config-manager/configs/production.yaml` - 生产环境配置
- `config-manager/configs/local.yaml` - 本地配置
- `config-manager/configs/secrets.yaml` - 密钥配置

### 3. 证书和密钥文件
- `*.pem` - PEM格式证书
- `*.key` - 私钥文件
- `*.crt` - 证书文件
- `*.csr` - 证书签名请求
- `*.p12` - PKCS#12格式证书
- `*.pfx` - PFX格式证书
- `id_rsa*` - SSH私钥
- `*.ppk` - PuTTY私钥

### 4. 数据库文件
- `*.db` - SQLite数据库
- `*.sqlite` - SQLite数据库
- `*.sqlite3` - SQLite数据库
- `dump.rdb` - Redis数据转储

### 5. 日志文件
- `*.log` - 日志文件
- `logs/` - 日志目录

### 6. 临时文件
- `tmp/` - 临时目录
- `temp/` - 临时目录
- `*.tmp` - 临时文件
- `*.temp` - 临时文件

### 7. 构建输出
- `node_modules/` - Node.js依赖
- `dist/` - 构建输出
- `build/` - 构建输出
- `__pycache__/` - Python缓存

## 安全检查工具

### 1. 自动安全检查
项目包含安全检查脚本，可以在提交前自动运行：

**Linux/macOS:**
```bash
bash scripts/security_check.sh
```

**Windows:**
```cmd
scripts\security_check.bat
```

### 2. Git钩子
已配置Git pre-commit钩子，在每次提交前自动进行安全检查。

## 配置模板

### 1. 环境变量模板
复制 `env.example` 为 `.env` 并填入实际值：
```bash
cp env.example .env
```

### 2. 生产环境配置模板
复制 `config-manager/configs/production.yaml.example` 为 `production.yaml`：
```bash
cp config-manager/configs/production.yaml.example config-manager/configs/production.yaml
```

## 安全最佳实践

### 1. 环境变量管理
- 使用环境变量而不是硬编码的密钥
- 定期轮换API密钥和密码
- 使用密钥管理服务（如AWS KMS、Azure Key Vault）

### 2. 配置文件安全
- 生产环境配置文件不应提交到代码仓库
- 使用配置管理工具（如Ansible、Terraform）
- 定期审计配置文件权限

### 3. 数据库安全
- 使用强密码
- 启用SSL/TLS连接
- 限制数据库访问IP

### 4. 网络安全
- 使用防火墙限制端口访问
- 启用HTTPS
- 配置反向代理

## 常见问题

### Q: 如何添加新的敏感文件类型？
A: 编辑 `.gitignore` 文件，添加相应的文件模式。

### Q: 如何检查当前的安全状态？
A: 运行安全检查脚本：
```bash
# Linux/macOS
bash scripts/security_check.sh

# Windows
scripts\security_check.bat
```

### Q: 如何禁用安全检查？
A: 删除或重命名 `.git/hooks/pre-commit` 文件。

### Q: 如何处理误报？
A: 在安全检查脚本中添加相应的排除规则。

## 紧急情况

如果发现敏感信息已提交到仓库：

1. **立即更改密钥**：更改所有已泄露的密钥和密码
2. **从历史记录中移除**：使用 `git filter-branch` 或 `BFG Repo-Cleaner` 从历史记录中移除敏感文件
3. **通知相关人员**：通知所有可能受到影响的人员
4. **审计访问日志**：检查是否有未授权的访问

## 联系信息

如有安全问题，请联系：
- 项目维护者：[维护者邮箱]
- 安全团队：[安全团队邮箱] 